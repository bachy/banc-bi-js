var _=require("underscore");module.exports=function(e,a,i){function n(e,a){a.render("index",{pageData:{title:"museo",images:i.getImages()}})}function t(e,i){data={images:{}};for(key in e.body)(match=key.match(/image-(\d+)/))?data.images[match[1]]=e.body[key]:data[key]=e.body[key];return console.log("data",data),_.isUndefined(data.legend)||_.isEmpty(data.legend.trim())?i.json(400,{error:"Legend is invalid"}):(a.sockets.emit("incomingLine",data),void i.json(200,{message:"New line received"}))}e.get("/",n),e.post("/newline",t)};